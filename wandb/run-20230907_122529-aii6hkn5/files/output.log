algorithm:
  name: jtt
  params:
    lambda_up: 100
    num_epochs_for_final_model: 300
  data_format: vector
model:
  name: linear_classifier
  linear_config:
    _target_: models.LinearClassifier
  params:
    num_classes: 2
    num_epochs: 60
  data_format: vector
dataset:
  name: resnet50_representation
  _target_: datamodule.representation_data.DataModule
  in_features: 2048
  batch_size: 64
  train_path: ${oc.env:DATA_ROOT}/resnet50/train.npz
  test_path: ${oc.env:DATA_ROOT}/resnet50/test.npz
  val_path: ${oc.env:DATA_ROOT}/resnet50/val.npz
  data_format: vector
optimizer:
  name: adam
  optim:
    _target_: torch.optim.Adam
    lr: 0.001
    weight_decay: 1.0e-05
loss:
  name: cross_entropy
  loss_function:
    _target_: torch.nn.CrossEntropyLoss
100%|████████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:02<00:00, 35.99it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 646.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 724.64it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 627.24it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 717.03it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 642.97it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 723.21it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 634.16it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 661.22it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 690.39it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 573.19it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 623.25it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 624.41it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 671.66it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 550.63it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 666.73it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 668.33it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 585.28it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 627.46it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 627.72it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 448.53it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 541.04it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 654.25it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 622.02it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 573.18it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 523.02it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 625.60it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 625.92it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 668.45it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 593.07it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 638.95it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 624.49it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 435.08it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 568.95it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 600.28it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 629.15it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 651.97it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 659.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 669.51it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 635.22it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 624.04it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 606.11it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 629.33it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 608.43it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 624.04it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 577.10it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 601.07it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 650.00it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 583.94it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 587.50it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 671.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 622.08it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 582.52it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 575.42it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 583.44it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 579.06it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 617.97it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 622.93it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 666.58it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 659.31it/s]
Evaluate standard model performance
Checking accuracy on Training Set
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 896.99it/s]
Got 4768 / 4795 with accuracy 99.44
Checking accuracy on Test Set
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:00<00:00, 944.09it/s]
Got 4889 / 5794 with accuracy 84.38
Accuracy on waterbird_water
Got 434 / 642 with accuracy 67.60██████████████████████████████████████████████████████████████████| 5794/5794 [00:00<00:00, 6378.19it/s]
Got 613 / 642 with accuracy 95.48
Accuracy on waterbird_land
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 5794/5794 [00:00<00:00, 6470.85it/s]
Got 434 / 642 with accuracy 67.60██████████████████████████████████████████████████████████████████| 5794/5794 [00:00<00:00, 6378.19it/s]
Accuracy on landbird_land
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 5794/5794 [00:01<00:00, 5274.26it/s]
Got 2230 / 2255 with accuracy 98.89
Accuracy on landbird_water
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 5794/5794 [00:01<00:00, 4761.33it/s]
Got 1612 / 2255 with accuracy 71.49
 37%|██████████████████████████████████▎                                                           | 1752/4795 [00:00<00:00, 5527.51it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 689.50it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 772.61it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 808.31it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 726.95it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 790.04it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 811.42it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 689.50it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 842.28it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 862.91it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 855.64it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 949.52it/s]
 22%|█████████████████████▊                                                                            | 26/117 [00:00<00:00, 245.17it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 803.25it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 852.37it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 908.48it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 730.01it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 632.45it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 731.31it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 728.65it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 719.35it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 715.78it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 326.24it/s]
 22%|█████████████████████▊                                                                            | 26/117 [00:00<00:00, 245.17it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 252.48it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 296.17it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 260.14it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 223.14it/s]
 63%|█████████████████████████████████████████████████████████████▉                                    | 74/117 [00:00<00:00, 238.53it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 252.48it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 252.48it/s]
 71%|█████████████████████████████████████████████████████████████████████▌                            | 83/117 [00:00<00:00, 267.12it/s]
 71%|█████████████████████████████████████████████████████████████████████▌                            | 83/117 [00:00<00:00, 267.12it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 255.21it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 255.21it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 696.76it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 696.76it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 695.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 657.17it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 678.40it/s]
  0%|                                                                                                            | 0/117 [00:00<?, ?it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 658.03it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 714.43it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 683.94it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 731.95it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 723.87it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 806.44it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 769.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 676.80it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 562.07it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 726.20it/s]
 71%|█████████████████████████████████████████████████████████████████████▌                            | 83/117 [00:00<00:00, 791.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 805.36it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 710.62it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 765.91it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 807.85it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 723.81it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 719.78it/s]
  0%|                                                                                                            | 0/117 [00:00<?, ?it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 721.02it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 779.61it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 732.55it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 790.32it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 764.31it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 810.27it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 767.01it/s]
  0%|                                                                                                            | 0/117 [00:00<?, ?it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 808.48it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 810.28it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 851.58it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 809.24it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 680.61it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 740.93it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 763.55it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 805.80it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 814.37it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 852.26it/s]
  0%|                                                                                                            | 0/117 [00:00<?, ?it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 682.66it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 808.10it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 757.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 802.26it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 814.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 911.16it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 769.76it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 762.04it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 775.23it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 606.95it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 795.46it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 682.66it/s]
Accuracy on landbird_land█████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 567.87it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 700.21it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 690.61it/s]
Validation Group Accuracies
Accuracy on waterbird_water
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 1199/1199 [00:00<00:00, 5328.85it/s]
Got 124 / 133 with accuracy 93.23
Accuracy on waterbird_land
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 1199/1199 [00:00<00:00, 5139.48it/s]
Got 80 / 133 with accuracy 60.15
Accuracy on landbird_land█████████████████████████████████████████████████████████████████████████████| 117/117 [00:00<00:00, 567.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 1199/1199 [00:00<00:00, 4983.50it/s]
Got 462 / 467 with accuracy 98.93
Accuracy on landbird_water
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 1199/1199 [00:00<00:00, 4982.47it/s]
Got 348 / 466 with accuracy 74.68
Evaluate JTT performance
Checking accuracy on Training Set
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 75/75 [00:00<00:00, 844.39it/s]
Got 4775 / 4795 with accuracy 99.58
Checking accuracy on Test Set
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:00<00:00, 942.07it/s]
Got 5004 / 5794 with accuracy 86.37
Accuracy on waterbird_water
100%|██████████████████████████████████████████████████████████████████████████████████████████████| 5794/5794 [00:01<00:00, 5597.07it/s]
Got 595 / 642 with accuracy 92.68
Accuracy on waterbird_land
 79%|██████████████████████████████████████████████████████████████████████████▏                   | 4576/5794 [00:00<00:00, 5716.59it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:00<00:00, 942.07it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:00<00:00, 942.07it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:00<00:00, 942.07it/s]